// Utilities
@import "./utility";

.CodeMirror {
	font-family: monospace;
	height: 300px;
	color: #000;
	direction: ltr;
    position: relative;
	overflow: hidden;
	background: $primary-dark;
    pre.CodeMirror-line,
    pre.CodeMirror-line-like {
        padding: 0 4px;
    }
    div.CodeMirror-secondarycursor {
        border-left: 1px solid silver;
    }
    pre.CodeMirror-line,
    pre.CodeMirror-line-like {
        border-radius: 0;
        border-width: 0;
        background: 0 0;
        font-family: inherit;
        font-size: inherit;
        margin: 0;
        white-space: pre;
        word-wrap: normal;
        line-height: inherit;
        color: inherit;
        z-index: 2;
        position: relative;
        overflow: visible;
        -webkit-tap-highlight-color: transparent;
        -webkit-font-variant-ligatures: contextual;
        font-variant-ligatures: contextual;
    }
    // .cm-spell-error:not(.cm-url):not(.cm-comment):not(.cm-tag):not(.cm-word) {
    //     background: rgba(255, 0, 0, .05);
    // }
}
.CodeMirror-lines {
	padding: 4px 0;
}
.CodeMirror-gutter-filler,
.CodeMirror-scrollbar-filler {
	background-color: #fff;
}
.CodeMirror-gutters {
	border-right: 1px solid #ddd;
	background-color: #f7f7f7;
	white-space: nowrap;
}
.CodeMirror-linenumber {
	padding: 0 3px 0 5px;
	min-width: 20px;
	text-align: right;
	color: #999;
	white-space: nowrap;
}
.CodeMirror-guttermarker {
	color: #000;
}
.CodeMirror-guttermarker-subtle {
	color: #999;
}
.CodeMirror-cursor {
	border-left: 1px solid #fff;
	border-right: none;
	width: 0;
}
.cm-fat-cursor {
    caret-color: transparent;
    .CodeMirror-cursor {
        width: auto;
        border: 0 !important;
        background: #7e7;
    }
    div.CodeMirror-cursors {
        z-index: 1;
    }
    .CodeMirror-line {
        &::selection,
        > span::selection,
        > span > span::selection {
            background: 0 0;
        }
    }
}
.cm-tab {
	display: inline-block;
	text-decoration: inherit;
}
.CodeMirror-rulers {
	position: absolute;
	left: 0;
	right: 0;
	top: -50px;
	bottom: 0;
	overflow: hidden;
}
.CodeMirror-ruler {
	border-left: 1px solid #ccc;
	top: 0;
	bottom: 0;
	position: absolute;
}
.cm-negative {
	color: #d44;
}
.cm-positive {
	color: #292;
}
.cm-header,
.cm-strong {
	font-weight: 700;
}
.cm-em {
	font-style: italic;
}
.cm-link {
	text-decoration: underline;
}
.cm-strikethrough {
	text-decoration: line-through;
}
.cm-s-default {
    .cm-header {
        color: #00f;
    }
    .cm-quote {
        color: #090;
    }
    .cm-keyword {
        color: #708;
    }
    .cm-atom {
        color: #219;
    }
    .cm-number {
        color: #164;
    }
    .cm-def {
        color: #00f;
    }
    .cm-variable-2 {
        color: #05a;
    }
    .cm-type,
    .cm-variable-3 {
        color: #085;
    }
    .cm-comment {
        color: #a50;
    }
    .cm-string {
        color: #a11;
    }
    .cm-string-2 {
        color: #f50;
    }
    .cm-meta {
        color: #555;
    }
    .cm-qualifier {
        color: #555;
    }
    .cm-builtin {
        color: #30a;
    }
    .cm-bracket {
        color: #997;
    }
    .cm-tag {
        color: #170;
    }
    .cm-attribute {
        color: #00c;
    }
    .cm-hr {
        color: #999;
    }
    .cm-link {
        color: #00c;
    }
    .cm-error {
        color: red;
    }
}
.cm-invalidchar {
	color: red;
}
.CodeMirror-composing {
	border-bottom: 2px solid;
}
div.CodeMirror {
    span.CodeMirror-matchingbracket {
        color: #0b0;
    }
    
    span.CodeMirror-nonmatchingbracket {
        color: #a22;
    }
}
.CodeMirror-matchingtag {
	background: rgba(255, 150, 0, .3);
}
.CodeMirror-activeline-background {
	background: #e8f2ff;
}
.CodeMirror-scroll {
	overflow: scroll !important;
	margin-bottom: -50px;
	margin-right: -50px;
	padding-bottom: 50px;
	height: 100%;
	outline: 0;
	position: relative;
}
.CodeMirror-sizer {
	position: relative;
	border-right: 50px solid transparent;
}
.CodeMirror-gutter-filler,
.CodeMirror-hscrollbar,
.CodeMirror-scrollbar-filler,
.CodeMirror-vscrollbar {
	position: absolute;
	z-index: 6;
	display: none;
	outline: 0;
}
.CodeMirror-vscrollbar {
	right: 0;
	top: 0;
	overflow-x: hidden;
	overflow-y: scroll;
}
.CodeMirror-hscrollbar {
	bottom: 0;
	left: 0;
	overflow-y: hidden;
	overflow-x: scroll;
}
.CodeMirror-scrollbar-filler {
	right: 0;
	bottom: 0;
}
.CodeMirror-gutter-filler {
	left: 0;
	bottom: 0;
}
.CodeMirror-gutters {
	position: absolute;
	left: 0;
	top: 0;
	min-height: 100%;
	z-index: 3;
}
.CodeMirror-gutter {
	white-space: normal;
	height: 100%;
	display: inline-block;
	vertical-align: top;
	margin-bottom: -50px;
}
.CodeMirror-gutter-wrapper {
	position: absolute;
	z-index: 4;
	background: 0 0 !important;
	border: none !important;
    ::selection {
        background-color: transparent;
    }
}
.CodeMirror-gutter-background {
	position: absolute;
	top: 0;
	bottom: 0;
	z-index: 4;
}
.CodeMirror-gutter-elt {
	position: absolute;
	cursor: default;
	z-index: 4;
}
.CodeMirror-lines {
	cursor: text;
	min-height: 1px;
}
.CodeMirror-wrap {
    pre.CodeMirror-line,
    pre.CodeMirror-line-like {
        word-wrap: break-word;
        white-space: pre-wrap;
        word-break: normal;
    }
}
.CodeMirror-linebackground {
	position: absolute;
	left: 0;
	right: 0;
	top: 0;
	bottom: 0;
	z-index: 0;
}
.CodeMirror-linewidget {
	position: relative;
	z-index: 2;
	padding: .1px;
}
.CodeMirror-rtl pre {
	direction: rtl;
}
.CodeMirror-code {
	outline: 0;
}
.CodeMirror-gutter,
.CodeMirror-gutters,
.CodeMirror-linenumber,
.CodeMirror-scroll,
.CodeMirror-sizer {
	box-sizing: content-box;
}
.CodeMirror-measure {
	position: absolute;
	width: 100%;
	height: 0;
	overflow: hidden;
	visibility: hidden;
}
.CodeMirror-cursor {
	position: absolute;
	pointer-events: none;
}
.CodeMirror-measure pre {
	position: static;
}
div.CodeMirror-cursors {
	visibility: hidden;
	position: relative;
	z-index: 3;
}
div.CodeMirror-dragcursors {
	visibility: visible;
}
.CodeMirror-focused {
    div.CodeMirror-cursors {
        visibility: visible;
    }
    .CodeMirror-selected {
        background: $green-op-2;
    }
}
.CodeMirror-selected {
	background: $green-op-2;
}
.CodeMirror-crosshair {
	cursor: crosshair;
}
.CodeMirror-line {
    &::selection,
    > span::selection,
    > span > span::selection {
        background: $green-op-2;
    }
}
.cm-searching {
	background-color: #ffa;
	background-color: rgba(255, 255, 0, .4);
}
.cm-force-border {
	padding-right: .1px;
}
@media print {
	.CodeMirror div.CodeMirror-cursors {
		visibility: hidden;
	}
}
.cm-tab-wrap-hack:after {
	content: '';
}
span.CodeMirror-selectedtext {
	background: 0 0;
}
.EasyMDEContainer {
	display: block;
    .CodeMirror {
        box-sizing: border-box;
        height: auto;
        border: 1px solid lighten($primary-dark, 5%);
        border-bottom-left-radius: 4px;
        border-bottom-right-radius: 4px;
        padding: 10px;
        font: inherit;
        z-index: 0;
        word-wrap: break-word;
    }
    .CodeMirror-scroll {
        cursor: text;
    }
    .CodeMirror-fullscreen {
        background: #fff;
        position: fixed !important;
        top: 50px;
        left: 0;
        right: 0;
        bottom: 0;
        height: auto;
        z-index: 8;
        border-right: none !important;
        border-bottom-right-radius: 0 !important;
    }
    .CodeMirror-sided {
        width: 50% !important;
    }
    .CodeMirror-placeholder {
        opacity: .5;
    }
    &.sided--no-fullscreen {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        .CodeMirror-sided {
            border-right: none !important;
            border-bottom-right-radius: 0;
            position: relative;
            flex: 1 1 auto;
        }
        .editor-toolbar, .editor-statusbar {
            width: 100%;
        }
        .editor-preview-active-side {
            flex: 1 1 auto;
            height: auto;
            position: static;
        }
    }
}
.editor-toolbar {
	position: relative;
	user-select: none;
	padding: 9px 10px;
    &.fullscreen {
        width: 100%;
        height: 50px;
        padding-top: 10px;
        padding-bottom: 10px;
        box-sizing: border-box;
        background: #fff;
        border: 0;
        position: fixed;
        top: 0;
        left: 0;
        opacity: 1;
        z-index: 9;
        &::before, &::after {
            width: 20px;
            height: 50px;
            position: fixed;
            top: 0;
            margin: 0;
            padding: 0;
        }
        &::before {
            background: linear-gradient(to right, #fff 0, rgba(255, 255, 255, 0) 100%);
            left: 0;
        }
        &::after {
            background: linear-gradient(to right, rgba(255, 255, 255, 0) 0, #fff 100%);
            right: 0;
        }
    }
    .easymde-dropdown, button {
        background: 0 0;
        display: inline-block;
        text-align: center;
        text-decoration: none !important;
        height: 30px;
        margin: 0;
        padding: 0;
        cursor: pointer;
    }
    button {
        width: 30px;
        background: darken($primary-dark, 3%);
        margin-left: 2px;
        margin-right: 2px;
        margin-top: 4px;
        &.active,
        &:hover {
            background: lighten($primary-dark, 5%);
        }
        &:after {
            font-family: Arial, "Helvetica Neue", Helvetica, sans-serif;
            font-size: 65%;
            vertical-align: text-bottom;
            position: relative;
            top: 2px;
        }
        &.heading-1:after {
            content: "1";
        }
        &.heading-2:after {
            content: "2";
        }
        &.heading-3:after {
            content: "3";
        }
        &.heading-bigger:after {
            content: "▲";
        }
        &.heading-smaller:after {
            content: "▼";
        }
    }
    i.separator {
        display: inline-block;
        width: 0;
        border-left: 1px solid lighten($primary-dark, 5%);
        border-right: 1px solid lighten($primary-dark, 5%);
        color: transparent;
        text-indent: -10px;
        margin: 0 6px;
    }
    &.disabled-for-preview button:not(.no-disable) {
        opacity: .6;
        pointer-events: none;
    }
}
@media only screen and (max-width:700px) {
	.editor-toolbar i.no-mobile {
		display: none;
	}
}
.editor-statusbar {
	padding: 8px 10px;
	font-size: 12px;
	color: #959694;
	text-align: right;
}
.editor-statusbar {
    span {
        display: inline-block;
        min-width: 4em;
        margin-left: 1em;
    }
    .lines:before {
        content: 'lines: ';
    }
    .words:before {
        content: 'words: ';
    }
    .characters:before {
        content: 'characters: ';
    }
}
.editor-preview-full {
	position: absolute;
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	z-index: 7;
	overflow: auto;
	display: none;
	box-sizing: border-box;
}
.editor-preview-side {
	position: fixed;
	bottom: 0;
	width: 50%;
	top: 50px;
	right: 0;
	z-index: 9;
	overflow: auto;
	display: none;
	box-sizing: border-box;
	border: 1px solid #ddd;
	word-wrap: break-word;
}
.editor-preview-active-side {
	display: block;
}
.editor-preview-active {
	display: block;
}
.editor-preview {
	padding: 10px;
	background: #fafafa;
    > p {
        margin-top: 0;
    }
    pre {
        background: #eee;
        margin-bottom: 10px;
    }
}
.editor-preview table {
    td, th {
        border: 1px solid #ddd;
        padding: 5px;
    }
}
.cm-s-easymde {
    .cm-tag {
        color: #63a35c;
    }
    .cm-attribute {
        color: #795da3;
    }
    .cm-string {
        color: #183691;
    }
    .cm-header-1 {
        font-size: 200%;
        line-height: 200%;
    }
    .cm-header-2 {
        font-size: 160%;
        line-height: 160%;
    }
    .cm-header-3 {
        font-size: 125%;
        line-height: 125%;
    }
    .cm-header-4 {
        font-size: 110%;
        line-height: 110%;
    }
    .cm-comment {
        color: darken($text, 10%);
        font-family: monospace;
        font-size: 14px;
    }
    .cm-link {
        color: lighten($blue-text, 15%);
    }
    .cm-url {
        color: lighten($blue-text, 8%);
    }
    .cm-quote {
        color: lighten($text, 10%);
        font-style: italic;
    }
    .cm-formatting-em,
    .cm-formatting-strong,
    .cm-formatting-strikethrough {
        color: darken($text, 20%);
    }
}
.editor-toolbar {
    .easymde-dropdown {
        position: relative;
        background: linear-gradient(to bottom right, #fff 0, #fff 84%, #333 50%, #333 100%);
        border-radius: 0;
        border: 1px solid #fff;
    }
    .easymde-dropdown:hover {
        background: linear-gradient(to bottom right, #fff 0, #fff 84%, #333 50%, #333 100%);
    }
}
.easymde-dropdown-content {
	display: block;
	visibility: hidden;
	position: absolute;
	background-color: #f9f9f9;
	box-shadow: 0 8px 16px 0 rgba(0, 0, 0, .2);
	padding: 8px;
	z-index: 2;
	top: 30px;
}
.easymde-dropdown {
    &:active, &:focus, &:focus-within {
        .easymde-dropdown-content {
            visibility: visible;
        }
    }
}
span[data-img-src]::after {
	content: '';
	background-image: var(--bg-image);
	display: block;
	max-height: 100%;
	max-width: 100%;
	background-size: contain;
	height: 0;
	padding-top: var(--height);
	width: var(--width);
	background-repeat: no-repeat;
}